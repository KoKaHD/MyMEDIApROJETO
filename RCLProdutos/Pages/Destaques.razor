@inject ApiService Api
@inject NavigationManager Nav

@if (destaque == null)
{
    <p>A carregar destaque...</p>
}
else
{
    <section class="destaque">
        <div class="destaque-img">
            <img src="@destaque.UrlImagem" alt="@destaque.Nome" />
        </div>

        <div class="destaque-body">
            <div class="destaque-tag">Em destaque</div>

            <h2 class="destaque-title">@destaque.Nome</h2>

            @if (!string.IsNullOrWhiteSpace(destaque.Detalhe))
            {
                <p class="destaque-text">@destaque.Detalhe</p>
            }

            <div class="destaque-footer">
                <div class="destaque-preco">€ @destaque.Preco.ToString("0.00")</div>
                <button class="btn btn-primary" @onclick="() => Nav.NavigateTo($" /produto/{destaque.Id}")">
                    Ver detalhe
                </button>
            </div>
        </div>
    </section>
}

@code {
    private ProdutoDTO? destaque;

    protected override async Task OnInitializedAsync()
    {
        var todos = await Api.GetProdutosAsync();
        if (todos?.Any() == true)
        {
            destaque = todos[Random.Shared.Next(todos.Count)];
        }
    }
}